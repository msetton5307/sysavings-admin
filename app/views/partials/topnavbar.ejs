<nav class="header-navbar navbar navbar-expand-lg align-items-center floating-nav navbar-light navbar-shadow container-xxl">
    <div class="navbar-container d-flex content">
        <div class="bookmark-wrapper d-flex align-items-center">
            <ul class="nav navbar-nav d-xl-none">
                <li class="nav-item"><a class="nav-link menu-toggle" href="#"><i class="ficon" data-feather="menu"></i></a></li>
            </ul>
            <!-- <ul class="nav navbar-nav">
                <li class="nav-item d-none d-xl-block"><a class="nav-link nav-link-style light_dark" id="light_dark" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Toggle Light / Dark Mode"><i class="ficon" data-feather="moon"></i></a></li>
            </ul> -->
        </div>
        <ul class="nav navbar-nav align-items-center ms-auto">
            <!-- <li class="nav-item d-md-block d-xl-none d-lg-block "><a class="nav-link nav-link-style" id="light_dark_2" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Toggle Light / Dark Mode"><i class="ficon" data-feather="moon"></i></a></li> -->

            <!-- Search Bar  -->

            <!-- <li class="nav-item nav-search"><a class="nav-link nav-link-search"><i class="ficon" data-feather="search"></i></a>
                <div class="search-input">
                    <div class="search-input-icon"><i data-feather="search"></i></div>
                    <input class="form-control input" type="text" placeholder="Search Admin Panel Pages . . ." tabindex="-1" data-search="search">
                    <div class="search-input-close"><i data-feather="x"></i></div>
                    <ul class="search-list search-list-main"></ul>
                </div>
            </li> -->

            <!-- Ends Search Bar  -->
 

            <% 
                const safeFullName = (user.full_name || '').trim();
                const safeFirstName = (user.first_name || '').trim();
                const safeLastName = (user.last_name || '').trim();
                const displayName = safeFullName || `${safeFirstName} ${safeLastName}`.trim();
                const roleDisplayName = (user.role && user.role.roleDisplayName) ? user.role.roleDisplayName : '';
                const initials = (() => {
                    if (safeFirstName || safeLastName) {
                        return `${safeFirstName.charAt(0)}${safeLastName.charAt(0)}`.toUpperCase();
                    }

                    if (safeFullName) {
                        return safeFullName
                            .split(' ')
                            .filter(Boolean)
                            .map(name => name.charAt(0))
                            .join('')
                            .slice(0, 2)
                            .toUpperCase();
                    }

                    return '';
                })();
            %>

            <li class="nav-item dropdown dropdown-user">
                <a class="nav-link dropdown-toggle dropdown-user-link" id="dropdown-user" href="#" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <div class="user-nav d-sm-flex d-none">
                        <span class="user-name fw-bolder"><%= displayName || 'User' %></span>
                        <span class="user-status"><%= roleDisplayName %></span>
                    </div>
                    <span class="avatar">
                        <% if (!user.profile_image) { %>
                        <div class="avatar bg-light-dark">
                            <div class="avatar-content"><%= initials || 'U' %></div>
                        </div>
                        <% } else { %>
                            <img class="round" src="/uploads/user/profile_pic/<%= user.profile_image %>" alt="avatar" height="40" width="40">
                        <% } %>
                        <span class="avatar-status-online"></span>
                    </span>
                </a>
                <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-user">
                    <a class="dropdown-item" href="<%= generateUrl('admin.profile', {id: user._id})%>">
                        <i class="me-50" data-feather="settings"></i>
                        Settings
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="<%= generateUrl('user.logout')%>">
                        <i class="me-50" data-feather="power"></i>
                        Logout
                    </a>
                </div>
            </li>
        </ul>
    </div>
</nav>